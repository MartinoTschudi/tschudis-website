<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paola & Martino - Wedding</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíç</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Biro Script Plus';
            src: url('fonts/BiroScriptPlus.woff2') format('woff2'),
                 url('fonts/BiroScriptPlus.woff') format('woff'),
                 url('fonts/BiroScriptPlus.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            color: #333;
            padding: 2rem 1rem;
            min-height: 100vh;
        }

        .container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
        }

        .section {
            background: white;
            padding: 3rem 2rem;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }

        .section:last-child {
            margin-bottom: 0;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #333;
            text-align: center;
            font-weight: 600;
        }

        .italian-quote {
            text-align: center;
            margin-bottom: 8rem;
        }

        .italian-quote img {
            max-width: 60%;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        .emoji {
            font-size: 4rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            display: block;
            text-align: center;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: #333;
            text-align: center;
        }

        p {
            font-size: 1.1rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .program-item {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e0e0e0;
        }

        .program-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .program-time {
            font-size: 1.3rem;
            font-weight: 600;
            color: #555;
            margin-bottom: 0.5rem;
        }

        .program-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .program-details {
            color: #666;
            line-height: 1.8;
            margin-bottom: 0.5rem;
        }

        .program-location {
            margin-top: 0.5rem;
        }

        .program-location a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        .program-location a:hover {
            text-decoration: underline;
        }

        .program-note {
            background: #fff3cd;
            padding: 1rem;
            border-radius: 10px;
            margin-top: 0.5rem;
            color: #856404;
            font-size: 0.95rem;
        }


        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
            font-size: 1rem;
            font-weight: 500;
        }

        input[type="text"] {
            width: 100%;
            padding: 0.875rem 1rem;
            font-size: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #666;
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .radio-option {
            flex: 1;
            position: relative;
        }

        .radio-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .radio-option label {
            display: block;
            padding: 0.875rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0;
            font-weight: 500;
        }

        .radio-option input[type="radio"]:checked + label {
            border-color: #333;
            background: #333;
            color: white;
        }

        .radio-option label:hover {
            border-color: #666;
            background: rgba(0, 0, 0, 0.05);
        }

        .radio-option input[type="radio"]:checked + label:hover {
            background: #333;
        }

        button {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            background: #333;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            font-family: inherit;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            background: #444;
        }

        button:active {
            transform: translateY(0);
        }

        .success-message {
            display: none;
            margin-top: 1.5rem;
            padding: 1rem;
            background: #e8f5e9;
            color: #2e7d32;
            border-radius: 10px;
            font-weight: 500;
        }

        .success-message.show {
            display: block;
        }

        .intro-text {
            text-align: center;
            margin-bottom: 2rem;
        }

        .date-banner {
            background: linear-gradient(135deg, #f8f8f8 0%, #f0f0f0 100%);
            border-radius: 16px;
            padding: 2.5rem 2rem;
            margin-top: 3rem;
            text-align: center;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .date-day {
            font-size: 0.75rem;
            color: #999;
            font-weight: 500;
            margin-bottom: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .date-full {
            font-size: 2.2rem;
            color: #333;
            font-weight: 400;
            line-height: 1.2;
            margin-bottom: 1.5rem;
            letter-spacing: -0.3px;
        }

        .date-divider {
            width: 50px;
            height: 2px;
            background: linear-gradient(to right, transparent, #ccc, transparent);
            margin: 0 auto 1.2rem;
        }

        .countdown {
            font-size: 0.85rem;
            color: #777;
            font-weight: 400;
            margin-top: 0;
            padding-top: 0;
            border-top: none;
            line-height: 1.6;
        }

        .countdown-number {
            font-weight: 600;
            color: #555;
            font-size: 0.95rem;
        }

        .language-selector {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            margin-top: 3rem;
        }

        .language-selector h2 {
            font-size: 1.5rem;
            color: #666;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .language-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .language-button {
            padding: 1rem 2.5rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            background: #333;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            font-family: inherit;
        }

        .language-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            background: #444;
        }

        .language-button:active {
            transform: translateY(0);
        }

        .main-content {
            display: none;
        }

        .main-content.show {
            display: block;
        }

        .language-selection-screen {
            display: block;
        }

        .language-selection-screen.hidden {
            display: none;
        }

        #changeLanguageLink {
            transition: opacity 0.2s ease;
        }

        #changeLanguageLink:hover {
            opacity: 1 !important;
            text-decoration: underline !important;
        }

        /* Confetti Animation */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            top: -10px;
            opacity: 0;
            animation: confetti-fall linear forwards;
        }

        .confetti:nth-child(1) { left: 10%; background: #ff6b6b; animation-duration: 3s; animation-delay: 0s; }
        .confetti:nth-child(2) { left: 20%; background: #4ecdc4; animation-duration: 3.5s; animation-delay: 0.2s; }
        .confetti:nth-child(3) { left: 30%; background: #ffe66d; animation-duration: 2.8s; animation-delay: 0.1s; }
        .confetti:nth-child(4) { left: 40%; background: #ff6b6b; animation-duration: 3.2s; animation-delay: 0.3s; }
        .confetti:nth-child(5) { left: 50%; background: #95e1d3; animation-duration: 3.7s; animation-delay: 0s; }
        .confetti:nth-child(6) { left: 60%; background: #ffe66d; animation-duration: 2.9s; animation-delay: 0.4s; }
        .confetti:nth-child(7) { left: 70%; background: #ff6b6b; animation-duration: 3.3s; animation-delay: 0.2s; }
        .confetti:nth-child(8) { left: 80%; background: #4ecdc4; animation-duration: 3.1s; animation-delay: 0.1s; }
        .confetti:nth-child(9) { left: 90%; background: #ffe66d; animation-duration: 3.6s; animation-delay: 0.3s; }
        .confetti:nth-child(10) { left: 15%; background: #95e1d3; animation-duration: 2.7s; animation-delay: 0.2s; }
        .confetti:nth-child(11) { left: 25%; background: #ff6b6b; animation-duration: 3.4s; animation-delay: 0.1s; }
        .confetti:nth-child(12) { left: 35%; background: #ffe66d; animation-duration: 3s; animation-delay: 0.4s; }
        .confetti:nth-child(13) { left: 45%; background: #4ecdc4; animation-duration: 3.5s; animation-delay: 0s; }
        .confetti:nth-child(14) { left: 55%; background: #ff6b6b; animation-duration: 2.8s; animation-delay: 0.3s; }
        .confetti:nth-child(15) { left: 65%; background: #95e1d3; animation-duration: 3.2s; animation-delay: 0.2s; }
        .confetti:nth-child(16) { left: 75%; background: #ffe66d; animation-duration: 3.6s; animation-delay: 0.1s; }
        .confetti:nth-child(17) { left: 85%; background: #4ecdc4; animation-duration: 2.9s; animation-delay: 0.4s; }
        .confetti:nth-child(18) { left: 95%; background: #ff6b6b; animation-duration: 3.3s; animation-delay: 0s; }
        .confetti:nth-child(19) { left: 5%; background: #ffe66d; animation-duration: 3.1s; animation-delay: 0.3s; }
        .confetti:nth-child(20) { left: 50%; background: #95e1d3; animation-duration: 3.7s; animation-delay: 0.2s; }

        @keyframes confetti-fall {
            0% {
                opacity: 1;
                transform: translateY(0) translateX(0) rotate(0deg);
            }
            50% {
                opacity: 1;
                transform: translateY(50vh) translateX(20px) rotate(360deg);
            }
            100% {
                opacity: 0.8;
                transform: translateY(100vh) translateX(-20px) rotate(720deg);
            }
        }

        .confetti-circle {
            border-radius: 50%;
        }

        .confetti-square {
            border-radius: 2px;
        }

        .confetti-triangle {
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 10px solid;
            background: transparent !important;
        }
    </style>
</head>
<body>
    <!-- Language Selection Screen -->
    <div class="container language-selection-screen" id="languageSelection">
        <div class="section">
            <span class="emoji">üíç</span>
            <h1>Paola & Martino</h1>
            <div class="italian-quote">
                <img src="quote.png" alt="Ci sposiamo, ma niente di serio.">
            </div>
            <div class="language-selector">
                <h2 data-translate="selectLanguage">Seleziona la lingua</h2>
                <div class="language-buttons">
                    <button class="language-button" onclick="selectLanguage('dialet')">Dialet</button>
                    <button class="language-button" onclick="selectLanguage('it')">Italiano</button>
                    <button class="language-button" onclick="selectLanguage('de')">Deutsch</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container main-content" id="mainContent">
        <!-- Section 1: Title & Date -->
        <div class="section">
            <span class="emoji">üíç</span>
            <h1>Paola & Martino</h1>
            <div class="italian-quote">
                <img src="quote.png" alt="Ci sposiamo, ma niente di serio.">
            </div>
            <div class="date-banner">
                <div class="date-day" data-translate="friday">Friday</div>
                <div class="date-full" data-translate="february20">February 20th</div>
                <div class="date-divider"></div>
                <div id="countdown" class="countdown"></div>
            </div>
        </div>

        <!-- Section 2: Program -->
        <div class="section">
            <h2 data-translate="program">Program</h2>

            <div class="program-item">
                <div class="program-time">13:30</div>
                <div class="program-title" data-translate="ceremony">Ceremony</div>
                <div class="program-details" data-translate="ceremonyDuration">
                    The ceremony will last 15 to 30 minutes.
                </div>
                <div class="program-location">
                    <a href="https://www.google.com/maps/search/?api=1&query=Stadthaus+Z√ºrich,+Stadthausquai+17,+8001+Z√ºrich" target="_blank" rel="noopener noreferrer">
                        üìç Stadthaus Z√ºrich, Stadthausquai 17, 8001 Z√ºrich
                    </a>
                </div>
                <div class="program-note">
                    <strong data-translate="note">Note:</strong> <span data-translate="ceremonyNote">The place for the ceremony will be limited. We invite guests to wait outside the Stadthaus for our exit.</span>
                </div>
            </div>

            <div class="program-item">
                <div class="program-time">~14:00</div>
                <div class="program-title" data-translate="reception">Reception & Celebration</div>
                <div class="program-details" data-translate="receptionDetails">
                    We will move towards the Quartierzentrum Sch√ºtze for Mexican catering with our favorite tacos and palomas.
                </div>
                <div class="program-location">
                    <a href="https://www.google.com/maps/search/?api=1&query=Quartierzentrum+Sch√ºtze,+Heinrichstrasse+238,+8005+Z√ºrich" target="_blank" rel="noopener noreferrer">
                        üìç Quartierzentrum Sch√ºtze, Heinrichstrasse 238, 8005 Z√ºrich
                    </a>
                </div>
                <div class="program-note" style="margin-top: 0.5rem;" data-translate="transport">
                    Transport can be easily done with public transportation.
                </div>
            </div>

            <div class="program-item">
                <div class="program-time">~18:00</div>
                <div class="program-title" data-translate="endOfEvent">End of Event</div>
                <div class="program-details" style="margin-top: 0.5rem; font-style: italic; color: #666;" data-translate="endOfEventNote">
                    If you need a recommendation for a nice dining spot, or help booking a hotel, we are happy to help!
                </div>
            </div>
        </div>

        <!-- Section 3: RSVP -->
        <div class="section" style="display: none;">
            <h2 data-translate="rsvp">RSVP</h2>
            <p style="text-align: center; margin-bottom: 2rem;" data-translate="rsvpMessage">We'd love to celebrate with you! Please confirm your attendance.</p>
        
            <form id="rsvpForm">
            <div class="form-group">
                <label for="firstName" data-translate="firstName">First Name</label>
                <input type="text" id="firstName" name="firstName" data-translate-placeholder="firstNamePlaceholder" placeholder="Enter your first name" required>
            </div>
            <div class="form-group">
                <label for="lastName" data-translate="lastName">Last Name</label>
                <input type="text" id="lastName" name="lastName" data-translate-placeholder="lastNamePlaceholder" placeholder="Enter your last name" required>
            </div>
            <div class="form-group">
                <label data-translate="mealPreference">Meal Preference</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="vegetarian" name="meal" value="vegetarian" required>
                        <label for="vegetarian" data-translate="vegetarian">Vegetarian</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="meat" name="meal" value="meat" required>
                        <label for="meat" data-translate="meat">Meat</label>
                    </div>
                </div>
            </div>
            <button type="submit" data-translate="confirm">Confirm</button>
        </form>
        
            <div id="successMessage" class="success-message" data-translate="rsvpSuccess">
                Thank you! We've received your RSVP. üéâ
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 2rem; margin-bottom: 1rem;">
            <a href="#" id="changeLanguageLink" onclick="returnToLanguageSelection(); return false;" style="color: #666; text-decoration: none; font-size: 0.9rem; opacity: 0.7;">
                <span data-translate="changeLanguage">Change Language / Sprache √§ndern</span>
            </a>
        </div>
    </div>

    <script>
        // Google Apps Script Web App URL
        // Replace this with your deployed Apps Script URL after setup
        const RSVP_API_URL = 'https://script.google.com/macros/s/AKfycbx-EeeLriRt-WYlCgueSjEUofOWDRsrUga3FypOTWjLUcu2v_27CSca5l7xFl22Nqs/exec';
        
        // Translations
        const translations = {
            dialet: {
                selectLanguage: "Scern la lingua",
                friday: "Venerd√¨",
                february20: "20 de febrar",
                program: "Programma",
                ceremony: "Matrimoni civil",
                ceremonyDuration: "El matrimoni civil el durer√† circa 15-20 minut.",
                note: "Attenzion:",
                ceremonyNote: "El municipi de Zuric el ga poc post nela sala dela cerimonia. Quindi un va invida a speciac fora dala Stadthaus per festegi√† con num ala fin de la cerimonia.",
                reception: "Tacos & Palomas",
                receptionDetails: "Un sa sposter√† pe vers el Quartierzentrum Sch√ºtze dove ga specia un catering del nost food truck messican preferit.",
                transport: "El Quartierzentrum Sch√ºtze sal raggiung facilment con el tram.",
                endOfEvent: "Fin dela festa",
                endOfEventNote: "Se te ghe bisegn de un consili per un ristorant per scena, o una man a prenot√† un hotel, fac sav√©!",
                rsvp: "RSVP",
                rsvpMessage: "Ga piaserisa festegi√† con ti. Per pias√© conferma la to partecipazion.",
                firstName: "Nom",
                lastName: "Cognom",
                firstNamePlaceholder: "Inseris el to nom",
                lastNamePlaceholder: "Inseris el to cognom",
                mealPreference: "Cosa te vo mangia?",
                vegetarian: "Vegetarian",
                meat: "Carn",
                confirm: "Conferma",
                rsvpSuccess: "Grazie! Ma ricevu la conferma. üéâ",
                rsvpSuccessWithName: "Grazie, {name}! Ma ricevu la conferma. üéâ",
                submitting: "Un secont...",
                days: "d√¨",
                day: "d√¨",
                hours: "or",
                today: "Inche!",
                changeLanguage: "Cambia la lingua"
            },
            it: {
                selectLanguage: "Seleziona la lingua",
                friday: "Venerd√¨",
                february20: "20 Febbraio",
                program: "Programma",
                ceremony: "Cerimonia civile",
                ceremonyDuration: "La cerimonia durer√† circa 15-20 minuti.",
                note: "Nota:",
                ceremonyNote: "Il luogo dove si svolger√† la cerimonia ha i posti limitati. Vi invitiamo quindi ad aspettare fuori dalla Stadthaus per festeggiare con noi al termine della cerimonia.",
                reception: "Tacos & Palomas",
                receptionDetails: "Ci sposteremo verso il Quartierzentrum Sch√ºtze per un catering del nostro food truck messicano preferito.",
                transport: "Il Quartierzentrum Sch√ºtze √® facilemente raggiungibile con i mezzi pubblici.",
                endOfEvent: "Fine dell'evento",
                endOfEventNote: "Se hai bisogno di consigli per un bel ristorante per cena, o aiuto per prenotare un hotel, siamo felici di aiutarvi!",
                rsvp: "RSVP",
                rsvpMessage: "Ci piacerebbe festeggiare con te! Per favore conferma la tua partecipazione.",
                firstName: "Nome",
                lastName: "Cognome",
                firstNamePlaceholder: "Inserisci il tuo nome",
                lastNamePlaceholder: "Inserisci il tuo cognome",
                mealPreference: "Preferenza pasto",
                vegetarian: "Vegetariano",
                meat: "Carne",
                confirm: "Conferma",
                rsvpSuccess: "Grazie! Abbiamo ricevuto il tuo RSVP. üéâ",
                rsvpSuccessWithName: "Grazie, {name}! Abbiamo ricevuto la tua conferma. üéâ",
                submitting: "Invio in corso...",
                days: "giorni",
                day: "giorno",
                hours: "ore",
                today: "Oggi!",
                changeLanguage: "Cambia la lingua"
            },
            de: {
                selectLanguage: "Sprache w√§hlen",
                friday: "Freitag",
                february20: "20. Februar",
                program: "Programm",
                ceremony: "Zeremonie",
                ceremonyDuration: "Die Zeremonie dauert 15 bis 20 Minuten.",
                note: "Hinweis:",
                ceremonyNote: "Der Platz f√ºr die Zeremonie wird begrenzt sein. Wir laden die G√§ste ein, ausserhalb des Stadthauses auf uns zu warten und dann gemainsam zu feiern.",
                reception: "Tacos & Palomas",
                receptionDetails: "Wir werden zum Quartierzentrum Sch√ºtze f√ºr mexikanisches Catering mit unseren Lieblings-Tacos und Palomas weiterziehen.",
                transport: "Die Anreise kann einfach mit √∂ffentlichen Verkehrsmitteln erfolgen.",
                endOfEvent: "Ende der Veranstaltung",
                endOfEventNote: "Wenn du eine Empfehlung f√ºr ein sch√∂nes Restaurant brauchst oder Hilfe bei der Hotelbuchung, helfen wir gerne!",
                rsvp: "RSVP",
                rsvpMessage: "Wir w√ºrden gerne mit dir feiern! Bitte best√§tige deine Teilnahme.",
                firstName: "Vorname",
                lastName: "Nachname",
                firstNamePlaceholder: "Gib deinen Vornamen ein",
                lastNamePlaceholder: "Gib deinen Nachnamen ein",
                mealPreference: "Essensvorliebe",
                vegetarian: "Vegetarisch",
                meat: "Fleisch",
                confirm: "Best√§tigen",
                rsvpSuccess: "Danke! Wir haben deine RSVP erhalten. üéâ",
                rsvpSuccessWithName: "Danke, {name}! Wir haben deine RSVP erhalten. üéâ",
                submitting: "Wird gesendet...",
                days: "Tage",
                day: "Tag",
                hours: "Stunden",
                today: "Heute!",
                changeLanguage: "Sprache √§ndern"
            }
        };

        // Current language
        let currentLanguage = localStorage.getItem('weddingLanguage') || null;

        // Language selection function
        function selectLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('weddingLanguage', lang);
            document.getElementById('languageSelection').classList.add('hidden');
            document.getElementById('mainContent').classList.add('show');
            applyTranslations(lang);
        }

        // Return to language selection
        function returnToLanguageSelection() {
            document.getElementById('languageSelection').classList.remove('hidden');
            document.getElementById('mainContent').classList.remove('show');
            // Clear language selection to show both language options again
            currentLanguage = null;
            localStorage.removeItem('weddingLanguage');
        }

        // Apply translations
        function applyTranslations(lang) {
            const langData = translations[lang];
            if (!langData) return;

            // Translate elements with data-translate attribute
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (langData[key]) {
                    element.textContent = langData[key];
                }
            });

            // Translate placeholders
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (langData[key]) {
                    element.placeholder = langData[key];
                }
            });

            // Update countdown text
            updateCountdown();
        }

        // Initialize: show language selection if no language chosen
        if (!currentLanguage) {
            document.getElementById('languageSelection').classList.remove('hidden');
            document.getElementById('mainContent').classList.remove('show');
        } else {
            document.getElementById('languageSelection').classList.add('hidden');
            document.getElementById('mainContent').classList.add('show');
            applyTranslations(currentLanguage);
        }
        
        // Countdown to wedding date
        function updateCountdown() {
            const today = new Date();
            const currentYear = today.getFullYear();
            let weddingDate = new Date(currentYear, 1, 20); // February 20th (month is 0-indexed)
            
            // If the date has passed this year, use next year
            if (weddingDate < today) {
                weddingDate = new Date(currentYear + 1, 1, 20);
            }
            
            const diff = weddingDate - today;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            const countdownEl = document.getElementById('countdown');
            if (!countdownEl) return;
            
            const langData = currentLanguage ? translations[currentLanguage] : null;
            const dayText = langData ? (days === 1 ? langData.day : langData.days) : (days === 1 ? 'day' : 'days');
            const hourText = langData ? langData.hours : 'hours';
            const todayText = langData ? langData.today : 'Today!';
            
            if (days < 0) {
                if (currentLanguage === 'it') {
                    countdownEl.textContent = 'Il matrimonio √® passato!';
                } else if (currentLanguage === 'de') {
                    countdownEl.textContent = 'Die Hochzeit ist vorbei!';
                } else if (currentLanguage === 'dialet' && langData) {
                    countdownEl.textContent = langData.weddingPassed || 'The wedding has passed!';
                } else {
                    countdownEl.textContent = 'The wedding has passed!';
                }
            } else if (days === 0) {
                countdownEl.innerHTML = `<span class="countdown-number">${todayText}</span>`;
            } else if (days === 1) {
                countdownEl.innerHTML = `<span class="countdown-number">${days}</span> ${dayText}, <span class="countdown-number">${hours}</span> ${hourText}`;
            } else {
                countdownEl.innerHTML = `<span class="countdown-number">${days}</span> ${dayText}, <span class="countdown-number">${hours}</span> ${hourText}`;
            }
        }
        
        // Update countdown on load and every minute
        updateCountdown();
        setInterval(updateCountdown, 60000);

        document.getElementById('rsvpForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const meal = document.querySelector('input[name="meal"]:checked');
            const submitButton = e.target.querySelector('button[type="submit"]');
            const successMessage = document.getElementById('successMessage');
            
            if (!firstName || !lastName || !meal) {
                return;
            }

            // Disable button and show loading state
            submitButton.disabled = true;
            const langData = currentLanguage ? translations[currentLanguage] : null;
            submitButton.textContent = langData ? langData.submitting : 'Submitting...';
            successMessage.classList.remove('show');

            // Check if API URL is configured
            if (RSVP_API_URL === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
                const langData = currentLanguage ? translations[currentLanguage] : null;
                successMessage.textContent = 'Error: RSVP API URL not configured. Please set RSVP_API_URL in the script.';
                successMessage.style.background = '#ffebee';
                successMessage.style.color = '#c62828';
                successMessage.classList.add('show');
                submitButton.disabled = false;
                submitButton.textContent = langData ? langData.confirm : 'Confirm';
                return;
            }
            
            // Use a form submission approach that works better with Google Apps Script
            // Create a temporary form and submit it
            const form = document.createElement('form');
            form.method = 'GET';
            form.action = RSVP_API_URL;
            form.style.display = 'none';
            
            const firstNameInput = document.createElement('input');
            firstNameInput.type = 'hidden';
            firstNameInput.name = 'firstName';
            firstNameInput.value = encodeURIComponent(firstName);
            form.appendChild(firstNameInput);
            
            const lastNameInput = document.createElement('input');
            lastNameInput.type = 'hidden';
            lastNameInput.name = 'lastName';
            lastNameInput.value = encodeURIComponent(lastName);
            form.appendChild(lastNameInput);
            
            const mealInput = document.createElement('input');
            mealInput.type = 'hidden';
            mealInput.name = 'meal';
            mealInput.value = encodeURIComponent(meal.value);
            form.appendChild(mealInput);
            
            document.body.appendChild(form);
            
            // Create a hidden iframe to receive the response
            let responseFrame = document.getElementById('rsvp-response-frame');
            if (!responseFrame) {
                responseFrame = document.createElement('iframe');
                responseFrame.id = 'rsvp-response-frame';
                responseFrame.name = 'rsvp-response-frame';
                responseFrame.style.display = 'none';
                responseFrame.style.width = '0';
                responseFrame.style.height = '0';
                responseFrame.style.border = 'none';
                document.body.appendChild(responseFrame);
            }
            
            form.target = 'rsvp-response-frame';
            
            // Set up response handler
            let handled = false;
            const handleResponse = () => {
                if (handled) return;
                handled = true;
                
                // Wait a bit for the response to load
                setTimeout(() => {
                    try {
                        // Try to read response from iframe
                        const iframeDoc = responseFrame.contentDocument || responseFrame.contentWindow.document;
                        if (iframeDoc && iframeDoc.body) {
                            const responseText = iframeDoc.body.textContent || iframeDoc.body.innerText || '';
                            try {
                                const data = JSON.parse(responseText.trim());
                                showSuccess(data);
                            } catch (e) {
                                // If we can't parse JSON, check if it looks like success
                                if (responseText.includes('success') || responseText.length > 0) {
                                    showSuccess({ success: true, isUpdate: false });
                                } else {
                                    showSuccess({ success: true, isUpdate: false });
                                }
                            }
                        } else {
                            // Can't read response, assume success
                            showSuccess({ success: true, isUpdate: false });
                        }
                    } catch (e) {
                        // Cross-origin error - this is expected, assume success
                        showSuccess({ success: true, isUpdate: false });
                    }
                    
                    // Clean up
                    form.remove();
                }, 500);
            };
            
            // Listen for iframe load
            responseFrame.onload = handleResponse;
            responseFrame.onerror = () => {
                if (!handled) {
                    handled = true;
                    showSuccess({ success: true, isUpdate: false });
                    form.remove();
                }
            };
            
            // Submit the form
            form.submit();
            
            // Fallback: show success after 2 seconds
            setTimeout(() => {
                if (!handled) {
                    handled = true;
                    showSuccess({ success: true, isUpdate: false });
                    form.remove();
                }
            }, 2000);
            
            function showSuccess(data) {
                const langData = currentLanguage ? translations[currentLanguage] : null;
                const mealText = meal.value === 'vegetarian' 
                    ? (langData ? langData.vegetarian : 'vegetarian')
                    : (langData ? langData.meat : 'meat');
                const fullName = `${firstName} ${lastName}`;
                
                // Use translation template if available, otherwise fallback
                let thankYouText;
                if (langData && langData.rsvpSuccessWithName) {
                    thankYouText = langData.rsvpSuccessWithName
                        .replace('{name}', fullName)
                        .replace('{meal}', mealText);
                } else {
                    // Fallback to English
                    thankYouText = `Thank you, ${fullName}! We've received your RSVP for ${mealText} tacos. üéâ`;
                }
                
                successMessage.textContent = thankYouText;
                successMessage.style.background = '#e8f5e9';
                successMessage.style.color = '#2e7d32';
                successMessage.classList.add('show');
                
                // Trigger confetti animation
                createConfetti();
                
                // Reset form
                document.getElementById('firstName').value = '';
                document.getElementById('lastName').value = '';
                document.querySelectorAll('input[name="meal"]').forEach(radio => {
                    radio.checked = false;
                });
                
                // Scroll to success message
                successMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                
                // Re-enable button
                submitButton.disabled = false;
                submitButton.textContent = langData ? langData.confirm : 'Confirm';
            }

            // Confetti animation function
            function createConfetti() {
                // Remove any existing confetti
                const existing = document.getElementById('confetti-container');
                if (existing) {
                    existing.remove();
                }

                // Create confetti container
                const container = document.createElement('div');
                container.id = 'confetti-container';
                container.className = 'confetti-container';
                document.body.appendChild(container);

                // Create confetti pieces
                const colors = ['#ff6b6b', '#4ecdc4', '#ffe66d', '#95e1d3'];
                const shapes = ['circle', 'square', 'triangle'];
                
                for (let i = 0; i < 30; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    // Random shape
                    const shape = shapes[Math.floor(Math.random() * shapes.length)];
                    if (shape === 'circle') {
                        confetti.classList.add('confetti-circle');
                    } else if (shape === 'square') {
                        confetti.classList.add('confetti-square');
                    } else if (shape === 'triangle') {
                        confetti.classList.add('confetti-triangle');
                        const color = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.borderBottomColor = color;
                    }
                    
                    // Random color for non-triangles
                    if (shape !== 'triangle') {
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    }
                    
                    // Random position and animation
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    confetti.style.animationDelay = (Math.random() * 0.5) + 's';
                    
                    container.appendChild(confetti);
                }

                // Remove confetti container after animation
                setTimeout(() => {
                    container.remove();
                }, 4000);
            }
        });
    </script>
</body>
</html>

